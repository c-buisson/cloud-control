#!/usr/bin/ruby

require 'json'

def add_guest_to_vm_list(name, ip)
vm_list="<%= data_folder %>/vm_list.json"

unless File.exists?(vm_list)
  puts "No JSON file yet, creating one..."

  first_vm="\"#{name}: #{ip}\": #{name.to_json}"

  f=File.new(vm_list, "w")
    f << "{"+first_vm+"}"
  f.close

else

  f=File.read(vm_list).to_s.gsub("=>", ":")
  y=JSON.parse(f)

  y["#{name}: #{ip}"] = name

  f=File.open(vm_list, "w")
    f << y
  f.close

end
end

def delete_guest_from_vm_list(name, ip)
vm_list="/srv/cloud-control/vm_list.json"

  f=File.read(vm_list).to_s.gsub("=>", ":")
  y=JSON.parse(f)
  y.delete("#{name}: #{ip}")

  f=File.open(vm_list, "w")
    f << y
  f.close

end
